<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [fellowiki-svncheckins] r23 - in trunk/fellowiki/wiki: . tests	tests/tests/simple_markup
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/fellowiki-svncheckins/2006-July/index.html" >
   <LINK REL="made" HREF="mailto:fellowiki-svncheckins%40lists.berlios.de?Subject=Re%3A%20%5Bfellowiki-svncheckins%5D%20r23%20-%20in%20trunk/fellowiki/wiki%3A%20.%20tests%0A%09tests/tests/simple_markup&In-Reply-To=%3C200607192217.k6JMHmZE023758%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000022.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[fellowiki-svncheckins] r23 - in trunk/fellowiki/wiki: . tests	tests/tests/simple_markup</H1>
    <B>fingerle at BerliOS</B> 
    <A HREF="mailto:fellowiki-svncheckins%40lists.berlios.de?Subject=Re%3A%20%5Bfellowiki-svncheckins%5D%20r23%20-%20in%20trunk/fellowiki/wiki%3A%20.%20tests%0A%09tests/tests/simple_markup&In-Reply-To=%3C200607192217.k6JMHmZE023758%40sheep.berlios.de%3E"
       TITLE="[fellowiki-svncheckins] r23 - in trunk/fellowiki/wiki: . tests	tests/tests/simple_markup">fingerle at mail.berlios.de
       </A><BR>
    <I>Thu Jul 20 00:17:48 CEST 2006</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000022.html">[fellowiki-svncheckins] r24 - in trunk/fellowiki/wiki: . tests	tests/tests/simple_markup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21">[ date ]</a>
              <a href="thread.html#21">[ thread ]</a>
              <a href="subject.html#21">[ subject ]</a>
              <a href="author.html#21">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: fingerle
Date: 2006-07-20 00:17:47 +0200 (Thu, 20 Jul 2006)
New Revision: 23

Added:
   trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_description.complete.xml
   trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_description.wiki
   trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_description_rename.complete.xml
   trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_description_rename.wiki
   trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_encoding.wiki
   trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_external.complete.xml
   trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_external.wiki
   trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_external_encoding.wiki
   trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_rename.complete.xml
   trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_rename.wiki
   trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_simple.complete.xml
   trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_simple.wiki
   trunk/fellowiki/wiki/tests/tests/simple_markup/link_encoding.wiki
   trunk/fellowiki/wiki/tests/tests/simple_markup/link_external.complete.xml
   trunk/fellowiki/wiki/tests/tests/simple_markup/link_external.wiki
   trunk/fellowiki/wiki/tests/tests/simple_markup/link_external_encoding_ftp.wiki
   trunk/fellowiki/wiki/tests/tests/simple_markup/link_external_encoding_http.wiki
   trunk/fellowiki/wiki/tests/tests/simple_markup/link_invalid.complete.xml
   trunk/fellowiki/wiki/tests/tests/simple_markup/link_invalid.wiki
   trunk/fellowiki/wiki/tests/tests/simple_markup/link_rename.complete.xml
   trunk/fellowiki/wiki/tests/tests/simple_markup/link_simple.complete.xml
   trunk/fellowiki/wiki/tests/tests/simple_markup/mailto_link.wiki
Removed:
   trunk/fellowiki/wiki/tests/tests/simple_markup/include_link_rename.wiki
   trunk/fellowiki/wiki/tests/tests/simple_markup/include_link_simple.wiki
Modified:
   trunk/fellowiki/wiki/parser.py
   trunk/fellowiki/wiki/tests/test_parser.py
   trunk/fellowiki/wiki/tests/tests/simple_markup/link_rename.wiki
   trunk/fellowiki/wiki/tests/tests/simple_markup/link_simple.wiki
Log:
- some work on links


Modified: trunk/fellowiki/wiki/parser.py
===================================================================
--- trunk/fellowiki/wiki/parser.py	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/parser.py	2006-07-19 22:17:47 UTC (rev 23)
@@ -46,6 +46,8 @@
 BLOCK_LEVEL = 'block level'
 PROC = 'procedure'
 MACRO = 'macro:'
+LINK = 'link'
+IMAGE_LINK = 'image link'
 
 
 SPECIAL_MARKUP = {'/': ('em', 'italic'),
@@ -69,7 +71,7 @@
         self.content = []
         self.attributes = {}
         self.callback = []
-        self.translation = None
+        self.translations = []
         
     def to_element_tree(self): 
         xhtml = ElementTree.Element(self.tag)
@@ -103,13 +105,13 @@
             xhtml.text = current_text
         else:
             sub_xhtml.tail = current_text
-        if self.translation is not None:
-            if self.translation[1] is None:
+        for translation in self.translations:
+            if translation[1] is None:
                 translations.append((xhtml, 
-                                     self.translation[0], 
-                                     self.translation[2]))
+                                     translation[0], 
+                                     translation[2]))
             else:
-                self.translation[1](xhtml,  self.translation[2])
+                translation[1](xhtml, translation[2])
         return xhtml, translations
         
     def is_empty(self):
@@ -492,14 +494,6 @@
     def render(self, new_token):
         PrefixToken.render(self, new_token)
         
-        
-        
-##class HeadlineToken(PrefixToken): 
-##    def do_prefix(self, new_token):
-##        new_token.xhtml.tag = 'h%i' % (len(self.token) - 1)
-##        self.tokens.insert(0, BeetweenParagraphsXHTML(new_token.xhtml, 
-##                                                      self.token))
-        
 class MacroToken(Token): 
     def render(self, new_token):
         if not self.block_level:
@@ -515,9 +509,8 @@
         self.xhtml.append(self.text)
         self.block_level = False
         
-        
-        match_obj = re.match(r'\{\{(([^\\\}\n\|]|\\.|\}[^\\\}\n\|]|\}\\.)*)' \
-                             r'\|(([^\\\}\n]|\\.|\}[^\\\}\n]|\}\\.)*)\}\}', 
+        match_obj = re.match(r'\{\{(([^\\\}\|]|\\.|\}(?=[^\}]))*)' \
+                             r'\|(([^\\\}]|\\.|\}(?=[^\}]))*)\}\}', 
                              self.text)
                              
         
@@ -553,9 +546,9 @@
         if not this_proc.get(DEFERRED):
             self.proc_not_deferred = this_proc[PROC]
             
-        self.xhtml.translation = (self.proc, 
+        self.xhtml.translations.append((self.proc, 
                                   self.proc_not_deferred,
-                                  self.parameter)
+                                  self.parameter))
         self.xhtml.attributes['class'] = 'macro_resolved'
         
         if this_proc.get(BLOCK_LEVEL):
@@ -563,11 +556,134 @@
             self.xhtml.tag = 'p'
             self.tokens.insert(0, BeetweenParagraphsXHTML(self.xhtml, self.token))
             
+class LinkToken(Token): 
+    def render(self, new_token):
+        new_token.prepend(self.xhtml)
+        
+    def evaluate(self, result, tokens, state, procs):
+        Token.evaluate(self, result, tokens, state, procs)
+        
+        self.xhtml = XMLElement('a')
+        
+        match_obj = re.match(r'\[\[(([^\\\]]|\\.|\](?=[^\]]))*)' \
+                               r'&gt;&gt;(([^\\\]]|\\.|\](?=[^\]]))*)\]\]', 
+                             self.text)
+        
+        if match_obj:
+            text, _, target, _ = match_obj.groups()
+        else:
+            text = target = self.text[2:-2]
+                
+        text = remove_escaping_backslashes(text)
+        target = remove_backslashes_and_whitespace(target)
+        
+        self.xhtml.append(text)
+        
+        if re.match(r'(http|ftp)://', target):
+            self.xhtml.attributes['class'] = 'link_external'
+            self.xhtml.attributes['href'] = target
+            return
+        
+        try:
+            link_proc = procs[LINK]
+        except KeyError:
+            self.xhtml.attributes['class'] = 'link_unresolved'
+            self.xhtml.tag = 'span'
+            return
             
-class LinkToken(Token): 
-    pass
-class EmbeddedLinkToken(LinkToken): 
-    pass
+        self.xhtml.translations.append((LINK, 
+                                       None,
+                                       [target]))
+        self.xhtml.attributes['class'] = 'link_internal'
+            
+class ImageLinkToken(Token): 
+    def render(self, new_token):
+        new_token.prepend(self.xhtml)
+        
+    def evaluate(self, result, tokens, state, procs):
+        Token.evaluate(self, result, tokens, state, procs)
+        
+        self.xhtml = XMLElement('a')
+        
+        # 1st attempt: description and link
+        match_obj = re.match(r'\[\[\[(([^\\\]]|\\.|\]{1,2}(?=[^\]]))*)' \
+                               r'\|\|(([^\\\]]|\\.|\]{1,2}(?=[^\]]))*)' \
+                                 r'&gt;&gt;(([^\\\]]|\\.|\]{1,2}(?=[^\]]))*)\]\]\]',
+                             self.text)
+                             
+        if match_obj:
+            image, _, description, _, target, _ = match_obj.groups()
+        else: # 2nd attempt: only link
+            match_obj = re.match(r'\[\[\[(([^\\\]]|\\.|\]{1,2}(?=[^\]]))*)' \
+                                     r'&gt;&gt;(([^\\\]]|\\.|\]{1,2}(?=[^\]]))*)\]\]\]', 
+                                 self.text)
+            if match_obj:
+                image, _, target, _ = match_obj.groups()
+                description = None
+            else: # 3rd attempt: only description
+                match_obj = re.match(r'\[\[\[(([^\\\]]|\\.|\]{1,2}(?=[^\]]))*)' \
+                                       r'\|\|(([^\\\]]|\\.|\]{1,2}(?=[^\]]))*)\]\]\]', 
+                                     self.text)
+                if match_obj:
+                    image, _, description, _ = match_obj.groups()
+                    target = None
+                else:
+                    image = self.text[3:-3]
+                    description = target = None
+        
+        
+        image = remove_backslashes_and_whitespace(image)
+        if description is not None:
+            description = remove_backslashes_and_whitespace(description)
+        else:
+            description = ''
+            
+        has_target = False
+        
+        if target is not None:
+            has_target = True
+            target = remove_backslashes_and_whitespace(target)
+            if re.match(r'(http|ftp)://', target):
+                self.xhtml.attributes['class'] = 'link_external'
+                self.xhtml.attributes['href'] = target
+            else:    
+                try:
+                    link_proc = procs[LINK]
+                    self.xhtml.translations.append((LINK, 
+                                                    None,
+                                                    [target]))
+                    self.xhtml.attributes['class'] = 'link_internal'
+                except KeyError:
+                    self.xhtml.tag = 'span'
+                    self.xhtml.attributes['class'] = 'link_unresolved'
+                    
+        if re.match(r'(http|ftp)://', image):
+            img = XMLElement('img')
+            img.attributes['class'] = 'img_external'
+            img.attributes['src'] = image
+            
+            img.attributes['alt'] = description
+                
+            if has_target:
+                self.xhtml.append(img)
+            else:
+                self.xhtml = img
+        else:   
+            try:
+                link_proc = procs[IMAGE_LINK]
+                self.xhtml.translations.append((IMAGE_LINK, 
+                                                None,
+                                                [image, description, has_target]))
+            except KeyError:
+                span = XMLElement('span')
+                
+                span.append(image)
+                if description &lt;&gt; '':
+                    span.append(&quot;: %s&quot; % description)
+                    
+                span.attributes['class'] = 'image_unresolved'
+                self.xhtml.append(span)
+    
 class TableToken(Token): 
     pass
 
@@ -594,19 +710,12 @@
                      token_factory(LineBreakOutputToken, preference=1)),
               # line break in input (non-printable)
               (40, r'[ \t]*\n[ \t]*', token_factory(LineBreakToken, preference=20)),
-              # include link start
-              (10, r'\[\[\[', token_factory(EmbeddedLinkToken, type='(', 
-                     preference=20)),
-              # include link stop
-              (10, r'\]\]\]', token_factory(EmbeddedLinkToken, type=')', 
-                     preference=20)),
-              # link start
-              (20, r'\[\[', token_factory(LinkToken, type='(', preference=20)),
-              # link stop
-              (20, r'\]\]', token_factory(LinkToken, type=')', preference=20)),
-              # link rename
-              (20, r'[ \t]&gt;&gt;[ \t]', token_factory(LinkToken, type='_', 
-                     preference=20)),
+              # image link
+              (10, r'\[\[\[([^\\\]\n]|\\.|\]{1,2}(?=[^\]]))*\]\]\]', 
+                    token_factory(ImageLinkToken, preference=20)),
+              # link
+              (20, r'\[\[([^\\\]\n]|\\.|\](?=[^\]]))*\]\]', 
+                    token_factory(LinkToken, preference=20)),
               # special enclosing markup
               (90, r'[/\*_=]', token_factory(SwitchMarkupToken, preference=90)),
               (10, r'\[[/\*_=\'&quot;^,#~]', token_factory(EncapsulateMarkupToken, 
@@ -628,7 +737,7 @@
                     preference=0)),
               (90, r'\|', token_factory(TableToken, type='_', preference=0)),
               # macros
-              (10, r'\{\{([^\\\}\n]|\\.|\}[^\\\}\n]|\}\\.)*\}\}', 
+              (10, r'\{\{([^\\\}\n]|\\.|\}(?=[^\}]))*\}\}', 
                     token_factory(MacroToken, preference=20)),
               # n-dash and m-dash
               (20, r'----+', token_factory(TextToken)),

Modified: trunk/fellowiki/wiki/tests/test_parser.py
===================================================================
--- trunk/fellowiki/wiki/tests/test_parser.py	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/test_parser.py	2006-07-19 22:17:47 UTC (rev 23)
@@ -28,18 +28,18 @@
 wer're using nosetests
 &quot;&quot;&quot;
 
-import unittest
 import codecs
 import sys
 
 from os.path import dirname, isdir, splitext, join, abspath, basename
 from os import listdir
 from copy import copy
+from urllib import quote
 from elementtree.ElementTree import tostring, fromstring, Element, SubElement
 from xml.parsers.xmlproc import xmlval, utils, xmldtd
 
 from fellowiki.wiki.parser import WikiParser, SPLIT, ESCAPE, PROC, MACRO, \
-                                  DEFERRED, BLOCK_LEVEL
+                                  DEFERRED, BLOCK_LEVEL, LINK, IMAGE_LINK
 
 # Pre-load the xhtml DTD once, since reloading for each xmlproc
 # would be a major performance hit.
@@ -73,7 +73,39 @@
         xhtml = SubElement(element, 'span', {'class': 'test_macro_class'}) 
         xhtml.text = '{MACRO %s: %s}' % (macro_name, unicode(args))
     return new_test_proc
+    
+def _link_test_proc(element, target):
+    if target in ['link1', 'link 2', 'link   3']:
+        element.set('class', '%s_resolved' % element.get('class'))
+        element.set('href', quote('/view/%s' % target))
+    else:
+        element.set('class', '%s_unresolved' % element.get('class'))
+        element.set('href', quote('/edit/%s' % target))
 
+def _image_link_test_proc(element, image, description, new_subelement):
+    if image in ['link1', 'link 2', 'link   3']:
+        if new_subelement:
+            xhtml = SubElement(element, 'img')
+        else:
+            xhtml = element
+            xhtml.tag = 'img'
+        
+        xhtml.set('class', 'image_internal_resolved')
+        xhtml.set('src', quote('/view_img/%s' % image))
+        xhtml.set('alt', description)
+        
+    else:
+        if new_subelement:
+            xhtml = SubElement(element, 'span')
+        else:
+            xhtml = element
+            xhtml.tag = 'span'
+        xhtml.set('class', 'image_internal_unresolved')
+        if description == '':
+            xhtml.text = image
+        else:
+            xhtml.text = &quot;%s: %s&quot; % (image, description)
+
 procs = {MACRO + 'macro default': {PROC: _macro_test_proc('default macro'),
                                    SPLIT: True,
                                    ESCAPE: True},
@@ -94,7 +126,9 @@
                                     SPLIT: True,
                                     ESCAPE: True,
                                     DEFERRED: True,
-                                    BLOCK_LEVEL: True}}
+                                    BLOCK_LEVEL: True},
+         LINK: {PROC: _link_test_proc},
+         IMAGE_LINK: {PROC: _image_link_test_proc}}
 
 for (num, name) in enumerate(['testmacro', 'test macro2', 'Test: -Macro3-',
                               'testmacro4', 'testmacro5', 'testmacro6',
@@ -175,7 +209,7 @@
         
         # do one 'round trip' to get a canonical form
         xhtml_text_wiki_ext = tostring(xhtml_tree_wiki_ext)
-        xhtml_tree_wiki_ext_cononical = fromstring(xhtml_text_wiki_ext)
+        xhtml_tree_wiki_ext_canonical = fromstring(xhtml_text_wiki_ext)
         
         # read expected XML tree from file
         try:
@@ -188,7 +222,7 @@
         xhtml_tree = fromstring(xhtml_text)
         
         # and now for the tests
-        _assert_etrees(xhtml_tree, xhtml_tree_wiki_ext_cononical)
+        _assert_etrees(xhtml_tree, xhtml_tree_wiki_ext_canonical)
         xhtml_validator.parse_resource(xhtml_fn) # validate as XHTML
         
     except AssertionError, ex_val:

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_description.complete.xml
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_description.complete.xml	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_description.complete.xml	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1 @@
+&lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot;&gt;&lt;head&gt;&lt;title /&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=&quot;parsed-wiki-content&quot;&gt;&lt;p&gt;&lt;img alt=&quot;This image shows you everything at link 1.&quot; class=&quot;image_internal_resolved&quot; src=&quot;/view_img/link1&quot; /&gt; &lt;img alt=&quot;Link 2 is the most important image ever.&quot; class=&quot;image_internal_resolved&quot; src=&quot;/view_img/link%202&quot; /&gt; &lt;img alt=&quot;The   same   for   link  3.&quot; class=&quot;image_internal_resolved&quot; src=&quot;/view_img/link%20%20%203&quot; /&gt; &lt;span class=&quot;image_internal_unresolved&quot;&gt;link 4: This is link 4.&lt;/span&gt; &lt;span class=&quot;image_internal_unresolved&quot;&gt;link 5: And link 5.&lt;/span&gt; &lt;span class=&quot;image_internal_unresolved&quot;&gt;||: |&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
\ No newline at end of file

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_description.wiki
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_description.wiki	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_description.wiki	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1,6 @@
+[[[link1 ||This image shows you everything at link 1.]]]
+[[[ link 2 || Link 2 is the most important image ever. ]]]
+[[[link   3||The   same   for   link  3.]]]
+[[[ link 4|| This is link 4.]]]
+[[[link 5 ||And link 5. ]]]
+[[[\||||\|]]]

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_description_rename.complete.xml
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_description_rename.complete.xml	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_description_rename.complete.xml	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1 @@
+&lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot;&gt;&lt;head&gt;&lt;title /&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=&quot;parsed-wiki-content&quot;&gt;&lt;p&gt;&lt;a class=&quot;link_internal_resolved&quot; href=&quot;/view/link%202&quot;&gt;&lt;img alt=&quot;This image shows you everything at link 1.&quot; class=&quot;image_internal_resolved&quot; src=&quot;/view_img/link1&quot; /&gt;&lt;/a&gt; &lt;a class=&quot;link_internal_resolved&quot; href=&quot;/view/link%20%20%203&quot;&gt;&lt;img alt=&quot;Link 2 is the most important image ever.&quot; class=&quot;image_internal_resolved&quot; src=&quot;/view_img/link%202&quot; /&gt;&lt;/a&gt; &lt;a class=&quot;link_internal_unresolved&quot; href=&quot;/edit/link%204&quot;&gt;&lt;img alt=&quot;The   same   for   link  3.&quot; class=&quot;image_internal_resolved&quot; src=&quot;/view_img/link%20%20%203&quot; /&gt;&lt;/a&gt; &lt;a class=&quot;link_internal_unresolved&quot; href=&quot;/edit/link%205&quot;&gt;&lt;span class=&quot;image_internal_unresolved&quot;&gt;link 4: This is link 4.&lt;/span&gt;&lt;/a&gt; &lt;a class=&quot;link_internal_unresolved&quot; href=&quot;/edit/%3E&quot;&gt;&lt;span class=&quot;image_internal_unresolved&quot;&gt;|||||&gt;&gt;&gt;&gt;&gt;||: |&gt;&gt;&lt;/span&gt;&lt;/a&gt; &lt;a class=&quot;link_internal_unresolved&quot; href=&quot;/edit/%3E%7C%7C%7C%7C%7C&quot;&gt;&lt;span class=&quot;image_in!
 ternal_unresolved&quot;&gt;&gt;&gt;&gt;&gt;&gt;||: |&gt;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
\ No newline at end of file

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_description_rename.wiki
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_description_rename.wiki	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_description_rename.wiki	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1,6 @@
+[[[link1||This image shows you everything at link 1.&gt;&gt; link 2 ]]]
+[[[ link 2 || Link 2 is the most important image ever. &gt;&gt;link   3]]]
+[[[link   3||The   same   for   link  3.&gt;&gt; link 4]]]
+[[[ link 4|| This is link 4.&gt;&gt;link 5 ]]]
+[[[\||||\|\&gt;&gt;&gt;&gt;\&gt;\||||\|\&gt;&gt;&gt;&gt;\&gt;]]]
+[[[\&gt;&gt;&gt;&gt;\&gt;\||||\|\&gt;&gt;&gt;&gt;\&gt;\||||\|]]]

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_encoding.wiki
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_encoding.wiki	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_encoding.wiki	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1,4 @@
+[[[look out for &#233;&#232;&#234;]]]
+[[[ a&#246;&#252; || &#223; ]]]
+[[[ &#228;&#246;&#252; &gt;&gt; &#233;&#232;&#234; ]]]
+[[[ &#228;&#246;&#252; || &#223; &gt;&gt; &#233;&#232;&#234; ]]]
\ No newline at end of file

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_external.complete.xml
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_external.complete.xml	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_external.complete.xml	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1 @@
+&lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot;&gt;&lt;head&gt;&lt;title /&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=&quot;parsed-wiki-content&quot;&gt;&lt;p&gt;&lt;img alt=&quot;&quot; class=&quot;img_external&quot; src=&quot;<A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A>&quot; /&gt; &lt;img alt=&quot;&quot; class=&quot;img_external&quot; src=&quot;<A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A>&quot; /&gt; &lt;img alt=&quot;This is an external example.&quot; class=&quot;img_external&quot; src=&quot;<A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A>&quot; /&gt; &lt;img alt=&quot;Yet another external example&quot; class=&quot;img_external&quot; src=&quot;<A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A>&quot; /&gt; &lt;a class=&quot;link_external&quot; href=&quot;<A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A>&quot;&gt;&lt;img alt=&quot;&quot; class=&quot;img_external&quot; src=&quot;<A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A>&quot; /&gt;&lt;/a&gt;] &lt;a class=&quot;link_external&quot; href=&quot;<A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A>&quot;&gt;&lt;span class=&quot;image_internal_unresolved&quot;&gt;link 5&lt;/span&gt;&lt;/a&gt; &lt;img alt=&quot;link1&quot; class=&quot;img_external&quot; src=&quot;<A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A>&quot; /&gt; &lt;a class=&quot;link_external&quot; href=&quot;<A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A>&quot;&gt;&lt;img alt=&quot;This is an external example.&quot; class=&quot;img_external&quot; src=&quot;<A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A>&quot; /&gt;&lt;/a&gt;] &lt;a class=&quot;link_internal_resolved&quot; href=&quot;/vie!
 w/link1&quot;&gt;&lt;img alt=&quot;Yet another external example&quot; class=&quot;img_external&quot; src=&quot;<A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A>&quot; /&gt;&lt;/a&gt; &lt;a class=&quot;link_external&quot; href=&quot;<A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A>&quot;&gt;&lt;span class=&quot;image_internal_unresolved&quot;&gt;link 5: And link 5.&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_external.wiki
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_external.wiki	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_external.wiki	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1,10 @@
+[[[ <A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A> ]]]
+[[[<A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A>]]]
+[[[ <A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A> || This is an external example. ]]]
+[[[<A HREF="http://127.0.0.1/example.png||Yet">http://127.0.0.1/example.png||Yet</A> another external example]]]
+[[[ <A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A> &gt;&gt;<A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A>]]]]
+[[[link 5 &gt;&gt; <A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A> ]]]
+[[[<A HREF="http://127.0.0.1/example.png||link1">http://127.0.0.1/example.png||link1</A>]]]
+[[[ <A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A> || This is an external example. &gt;&gt;<A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A>]]]]
+[[[<A HREF="http://127.0.0.1/example.png||Yet">http://127.0.0.1/example.png||Yet</A> another external example&gt;&gt;link1]]]
+[[[link 5 ||And link 5. &gt;&gt; <A HREF="http://127.0.0.1/example.png">http://127.0.0.1/example.png</A> ]]]

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_external_encoding.wiki
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_external_encoding.wiki	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_external_encoding.wiki	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1,8 @@
+[[[ <A HREF="http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456">http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456</A> ]]]
+[[[ <A HREF="http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456">http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456</A> || &#223; ]]]
+[[[ <A HREF="http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456">http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456</A> &gt;&gt; <A HREF="ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a">ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a</A> ]]]
+[[[ <A HREF="http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456">http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456</A> || &#223; &gt;&gt; <A HREF="ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a">ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a</A> ]]]
+[[[ <A HREF="ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a">ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a</A> ]]]
+[[[ <A HREF="ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a">ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a</A> || &#223; ]]]
+[[[ <A HREF="ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a">ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a</A> &gt;&gt; <A HREF="http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456">http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456</A> ]]]
+[[[ <A HREF="ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a">ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a</A> || &#223; &gt;&gt; <A HREF="http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456">http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456</A> ]]]
\ No newline at end of file

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_rename.complete.xml
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_rename.complete.xml	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_rename.complete.xml	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1 @@
+&lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot;&gt;&lt;head&gt;&lt;title /&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=&quot;parsed-wiki-content&quot;&gt;&lt;p&gt;&lt;a class=&quot;link_internal_resolved&quot; href=&quot;/view/link%202&quot;&gt;&lt;img alt=&quot;&quot; class=&quot;image_internal_resolved&quot; src=&quot;/view_img/link1&quot; /&gt;&lt;/a&gt; &lt;a class=&quot;link_internal_resolved&quot; href=&quot;/view/link%20%20%203&quot;&gt;&lt;img alt=&quot;&quot; class=&quot;image_internal_resolved&quot; src=&quot;/view_img/link%202&quot; /&gt;&lt;/a&gt; &lt;a class=&quot;link_internal_unresolved&quot; href=&quot;/edit/link%204&quot;&gt;&lt;img alt=&quot;&quot; class=&quot;image_internal_resolved&quot; src=&quot;/view_img/link%20%20%203&quot; /&gt;&lt;/a&gt; &lt;a class=&quot;link_internal_unresolved&quot; href=&quot;/edit/link%205&quot;&gt;&lt;span class=&quot;image_internal_unresolved&quot;&gt;link 4&lt;/span&gt;&lt;/a&gt; &lt;a class=&quot;link_internal_unresolved&quot; href=&quot;/edit/%3E&quot;&gt;&lt;span class=&quot;image_internal_unresolved&quot;&gt;&gt;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
\ No newline at end of file

Copied: trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_rename.wiki (from rev 20, trunk/fellowiki/wiki/tests/tests/simple_markup/include_link_rename.wiki)
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/include_link_rename.wiki	2006-06-09 18:11:59 UTC (rev 20)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_rename.wiki	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1,5 @@
+[[[link1&gt;&gt; link 2 ]]]
+[[[ link 2 &gt;&gt;link   3]]]
+[[[link   3&gt;&gt; link 4]]]
+[[[ link 4&gt;&gt;link 5 ]]]
+[[[\&gt;&gt;&gt;&gt;\&gt;]]]

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_simple.complete.xml
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_simple.complete.xml	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_simple.complete.xml	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1 @@
+&lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot;&gt;&lt;head&gt;&lt;title /&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=&quot;parsed-wiki-content&quot;&gt;&lt;p&gt;&lt;img alt=&quot;&quot; class=&quot;image_internal_resolved&quot; src=&quot;/view_img/link1&quot; /&gt; &lt;img alt=&quot;&quot; class=&quot;image_internal_resolved&quot; src=&quot;/view_img/link%202&quot; /&gt; &lt;img alt=&quot;&quot; class=&quot;image_internal_resolved&quot; src=&quot;/view_img/link%20%20%203&quot; /&gt; &lt;span class=&quot;image_internal_unresolved&quot;&gt;link 4&lt;/span&gt; &lt;span class=&quot;image_internal_unresolved&quot;&gt;link 5&lt;/span&gt; &lt;span class=&quot;image_internal_unresolved&quot;&gt;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;image_internal_unresolved&quot;&gt;||&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
\ No newline at end of file

Copied: trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_simple.wiki (from rev 20, trunk/fellowiki/wiki/tests/tests/simple_markup/include_link_simple.wiki)
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/include_link_simple.wiki	2006-06-09 18:11:59 UTC (rev 20)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/image_link_simple.wiki	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1,7 @@
+[[[link1]]]
+[[[ link 2 ]]]
+[[[link   3]]]
+[[[ link 4]]]
+[[[link 5 ]]]
+[[[\&gt;&gt;]]]
+[[[\||]]]

Deleted: trunk/fellowiki/wiki/tests/tests/simple_markup/include_link_rename.wiki
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/include_link_rename.wiki	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/include_link_rename.wiki	2006-07-19 22:17:47 UTC (rev 23)
@@ -1,2 +0,0 @@
-[[[include &gt;&gt; ressource]]]
-[[[ include  &gt;&gt;  ressource]]]

Deleted: trunk/fellowiki/wiki/tests/tests/simple_markup/include_link_simple.wiki
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/include_link_simple.wiki	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/include_link_simple.wiki	2006-07-19 22:17:47 UTC (rev 23)
@@ -1,5 +0,0 @@
-[[[include]]]
-[[[ include ]]]
-[[[include&gt;&gt;this]]]
-[[[include &gt;&gt;this]]]
-[[[include&gt;&gt; this]]]

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/link_encoding.wiki
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/link_encoding.wiki	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/link_encoding.wiki	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1,8 @@
+[[&#196;rger]]
+[[M&#246;glichkeit]]
+[[&#220;berheblichkeit]]
+[[d&#228;mlich]]
+[[&#246;fters]]
+[[&#252;bel]]
+[[Das &#228;, &#246;, &#252;, &#223;, &#196;. &#214; und &#220;]]
+[[ &#228;&#246;&#252; &gt;&gt; &#196;&#214;&#220; ]]
\ No newline at end of file

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/link_external.complete.xml
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/link_external.complete.xml	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/link_external.complete.xml	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1 @@
+&lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot;&gt;&lt;head&gt;&lt;title /&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=&quot;parsed-wiki-content&quot;&gt;&lt;p&gt;&lt;a class=&quot;link_external&quot; href=&quot;<A HREF="http://www.w3c.org/">http://www.w3c.org/</A>&quot;&gt;<A HREF="http://www.w3c.org/&lt;/a">http://www.w3c.org/&lt;/a</A>&gt; &lt;a class=&quot;link_external&quot; href=&quot;<A HREF="http://www.w3c.org/">http://www.w3c.org/</A>&quot;&gt;<A HREF="http://www.w3c.org/">http://www.w3c.org/</A> &lt;/a&gt; &lt;a class=&quot;link_external&quot; href=&quot;<A HREF="http://www.w3c.org/">http://www.w3c.org/</A>&quot;&gt; <A HREF="http://www.w3c.org/&lt;/a">http://www.w3c.org/&lt;/a</A>&gt; &lt;a class=&quot;link_external&quot; href=&quot;<A HREF="http://www.w3c.org">http://www.w3c.org</A>&quot;&gt;<A HREF="http://www.w3c.org&lt;/a">http://www.w3c.org&lt;/a</A>&gt; &lt;a class=&quot;link_external&quot; href=&quot;<A HREF="ftp://127.0.0.1/">ftp://127.0.0.1/</A>&quot;&gt;<A HREF="ftp://127.0.0.1/&lt;/a">ftp://127.0.0.1/&lt;/a</A>&gt; &lt;a class=&quot;link_internal_unresolved&quot; href=&quot;/edit/127.0.0.1&quot;&gt;127.0.0.1&lt;/a&gt; &lt;a class=&quot;link_internal_unresolved&quot; href=&quot;/edit/www.w3c.org&quot;&gt;www.w3c.org&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
\ No newline at end of file

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/link_external.wiki
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/link_external.wiki	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/link_external.wiki	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1,7 @@
+[[<A HREF="http://www.w3c.org/">http://www.w3c.org/</A>]]
+[[<A HREF="http://www.w3c.org/">http://www.w3c.org/</A> ]]
+[[ <A HREF="http://www.w3c.org/">http://www.w3c.org/</A>]]
+[[<A HREF="http://www.w3c.org">http://www.w3c.org</A>]]
+[[<A HREF="ftp://127.0.0.1/">ftp://127.0.0.1/</A>]]
+[[127.0.0.1]]
+[[www.w3c.org]]

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/link_external_encoding_ftp.wiki
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/link_external_encoding_ftp.wiki	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/link_external_encoding_ftp.wiki	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1,14 @@
+[[ <A HREF="ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a">ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a</A> ]]
+[[ <A HREF="ftp://&#228;&#246;&#252;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a">ftp://&#228;&#246;&#252;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a</A> ]]
+[[ <A HREF="ftp://ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a">ftp://ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a</A> ]]
+[[ <A HREF="ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;">ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;</A> ]]
+[[ <A HREF="ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/">ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/</A>]]
+[[ <A HREF="ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid">ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid</A> ]]
+[[ <A HREF="ftp://&#228;&#246;&#252;%EE%AB%ac%cB%De:&#223;%EE%AB%ac%cB%De@ftp.m&#252;ller.invalid">ftp://&#228;&#246;&#252;%EE%AB%ac%cB%De:&#223;%EE%AB%ac%cB%De@ftp.m&#252;ller.invalid</A> ]]
+[[ <A HREF="ftp://ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;">ftp://ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;</A> ]]
+[[ <A HREF="ftp://ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;/%EE%AB%ac%cB%De">ftp://ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;/%EE%AB%ac%cB%De</A> ]]
+[[ <A HREF="ftp://ftp.m&#252;ller.invalid/">ftp://ftp.m&#252;ller.invalid/</A>]]
+[[ <A HREF="ftp://ftp.m&#252;ller.invalid">ftp://ftp.m&#252;ller.invalid</A> ]]
+[[ <A HREF="ftp://ftp.m&#252;ller.invalid.%EE">ftp://ftp.m&#252;ller.invalid.%EE</A> ]]
+[[ ftp.m&#252;ller.invalid ]]
+[[ &#228;&#246;&#252; &gt;&gt; <A HREF="ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a">ftp://&#228;&#246;&#252;:&#223;@ftp.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;;type=a</A> ]]
\ No newline at end of file

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/link_external_encoding_http.wiki
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/link_external_encoding_http.wiki	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/link_external_encoding_http.wiki	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1,14 @@
+[[ <A HREF="http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456">http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456</A> ]]
+[[ <A HREF="hTtP://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456">hTtP://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456</A> ]]
+[[ <A HREF="HtTp://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456">HtTp://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456</A> ]]
+[[ <A HREF="http://&#228;&#246;&#252;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456">http://&#228;&#246;&#252;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456</A> ]]
+[[ <A HREF="http://www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;&amp;&#223;&#196;&#214;&#220;=123">http://www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;&amp;&#223;&#196;&#214;&#220;=123</A>]]
+[[ <A HREF="http://www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;">http://www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;</A> ]]
+[[ <A HREF="http://www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;/%EE%AB%ac%cB%De">http://www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;/%EE%AB%ac%cB%De</A> ]]
+[[ <A HREF="http://www.m&#252;ller.invalid">http://www.m&#252;ller.invalid</A> ]]
+[[ <A HREF="http://www.m&#252;ller.invalid.%EE">http://www.m&#252;ller.invalid.%EE</A> ]]
+[[ <A HREF="http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid">http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid</A> ]]
+[[ <A HREF="http://&#228;&#246;&#252;%EE%AB%ac%cB%De:&#223;%EE%AB%ac%cB%De@www.m&#252;ller.invalid">http://&#228;&#246;&#252;%EE%AB%ac%cB%De:&#223;%EE%AB%ac%cB%De@www.m&#252;ller.invalid</A> ]]
+[[ www.m&#252;ller.invalid ]]
+[[ &#228;&#246;&#252; &gt;&gt; <A HREF="http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456">http://&#228;&#246;&#252;:&#223;@www.m&#252;ller.invalid/~&#233;&#232;&#234;/&#228;&#246;&#252;?&#223;&#196;&#214;&#220;=123&amp;&#223;&#228;&#246;&#252;=456</A> ]]
+

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/link_invalid.complete.xml
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/link_invalid.complete.xml	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/link_invalid.complete.xml	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1 @@
+&lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot;&gt;&lt;head&gt;&lt;title /&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=&quot;parsed-wiki-content&quot;&gt;&lt;p&gt;[[link1] [link2]] [link3]&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
\ No newline at end of file

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/link_invalid.wiki
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/link_invalid.wiki	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/link_invalid.wiki	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1,3 @@
+[[link1]
+[link2]]
+[link3]

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/link_rename.complete.xml
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/link_rename.complete.xml	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/link_rename.complete.xml	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1 @@
+&lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot;&gt;&lt;head&gt;&lt;title /&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=&quot;parsed-wiki-content&quot;&gt;&lt;p&gt;&lt;a class=&quot;link_internal_resolved&quot; href=&quot;/view/link1&quot;&gt;This is just a description.&lt;/a&gt; &lt;a class=&quot;link_internal_resolved&quot; href=&quot;/view/link%202&quot;&gt; This is just another description. &lt;/a&gt; &lt;a class=&quot;link_internal_resolved&quot; href=&quot;/view/link%20%20%203&quot;&gt;  This  is  yet  another  description.  &lt;/a&gt; &lt;a class=&quot;link_internal_unresolved&quot; href=&quot;/edit/link%204&quot;&gt; Guess, what's this.&lt;/a&gt; &lt;a class=&quot;link_internal_unresolved&quot; href=&quot;/edit/link%205&quot;&gt;'nuff said. &lt;/a&gt; &lt;a class=&quot;link_internal_unresolved&quot; href=&quot;/edit/%3E&quot;&gt;&gt;&gt;&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
\ No newline at end of file

Modified: trunk/fellowiki/wiki/tests/tests/simple_markup/link_rename.wiki
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/link_rename.wiki	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/link_rename.wiki	2006-07-19 22:17:47 UTC (rev 23)
@@ -1,2 +1,6 @@
-[[link &gt;&gt; ressource]]
-[[ link  &gt;&gt;  resource ]]
+[[This is just a description.&gt;&gt;link1]]
+[[ This is just another description. &gt;&gt; link 2 ]]
+[[  This  is  yet  another  description.  &gt;&gt;  link   3]]
+[[ Guess, what's this.&gt;&gt; link 4]]
+[['nuff said. &gt;&gt;link 5 ]]
+[[\&gt;&gt;&gt;&gt;\&gt;]]

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/link_simple.complete.xml
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/link_simple.complete.xml	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/link_simple.complete.xml	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1 @@
+&lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot;&gt;&lt;head&gt;&lt;title /&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=&quot;parsed-wiki-content&quot;&gt;&lt;p&gt;&lt;a class=&quot;link_internal_resolved&quot; href=&quot;/view/link1&quot;&gt;link1&lt;/a&gt; &lt;a class=&quot;link_internal_resolved&quot; href=&quot;/view/link%202&quot;&gt; link 2 &lt;/a&gt; &lt;a class=&quot;link_internal_resolved&quot; href=&quot;/view/link%20%20%203&quot;&gt;link   3&lt;/a&gt; &lt;a class=&quot;link_internal_unresolved&quot; href=&quot;/edit/link%204&quot;&gt; link 4&lt;/a&gt; &lt;a class=&quot;link_internal_unresolved&quot; href=&quot;/edit/link%205&quot;&gt;link 5 &lt;/a&gt; &lt;a class=&quot;link_internal_unresolved&quot; href=&quot;/edit/%3E%3E&quot;&gt;&gt;&gt;&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
\ No newline at end of file

Modified: trunk/fellowiki/wiki/tests/tests/simple_markup/link_simple.wiki
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/link_simple.wiki	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/link_simple.wiki	2006-07-19 22:17:47 UTC (rev 23)
@@ -1,5 +1,6 @@
-[[link]]
-[[ link ]]
-[[link&gt;&gt;this]]
-[[link &gt;&gt;this]]
-[[link&gt;&gt; this]]
+[[link1]]
+[[ link 2 ]]
+[[link   3]]
+[[ link 4]]
+[[link 5 ]]
+[[\&gt;&gt;]]

Added: trunk/fellowiki/wiki/tests/tests/simple_markup/mailto_link.wiki
===================================================================
--- trunk/fellowiki/wiki/tests/tests/simple_markup/mailto_link.wiki	2006-06-10 10:19:08 UTC (rev 22)
+++ trunk/fellowiki/wiki/tests/tests/simple_markup/mailto_link.wiki	2006-07-19 22:17:47 UTC (rev 23)
@@ -0,0 +1,11 @@
+[[ mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/fellowiki-svncheckins">test at test.invalid</A> ]]
+[[ MaIlTo:<A HREF="https://lists.berlios.de/mailman/listinfo/fellowiki-svncheckins">test at test.invalid</A> ]]
+[[ mAiLtO:<A HREF="https://lists.berlios.de/mailman/listinfo/fellowiki-svncheckins">test at test.invalid</A> ]]
+[[ <A HREF="https://lists.berlios.de/mailman/listinfo/fellowiki-svncheckins">test at test.invalid</A> ]]
+[[mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/fellowiki-svncheckins">test at test.invalid</A>]]
+[[ test address &gt;&gt; mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/fellowiki-svncheckins">test at test.invalid</A>  ]]
+[[ mailto:&#228;&#246;&#252;@&#196;&#214;&#220;.invalid ]]
+[[[ mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/fellowiki-svncheckins">test at test.invalid</A> ]]]
+[[[ test &gt;&gt; mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/fellowiki-svncheckins">test at test.invalid</A> ]]]
+[[[ mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/fellowiki-svncheckins">test at test.invalid</A> &gt;&gt; test ]]]
+


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000022.html">[fellowiki-svncheckins] r24 - in trunk/fellowiki/wiki: . tests	tests/tests/simple_markup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21">[ date ]</a>
              <a href="thread.html#21">[ thread ]</a>
              <a href="subject.html#21">[ subject ]</a>
              <a href="author.html#21">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/fellowiki-svncheckins">More information about the fellowiki-svncheckins
mailing list</a><br>
</body></html>
